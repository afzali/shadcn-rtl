import{v as t,p as s,k as e,m as r,l as o,s as n}from"./index.js";import{c as a}from"./rtl-utils.js";import{c as i}from"./button2.js";import{a as c,d as l,c as p,b as u,m as h}from"./create-id.js";import{w as d}from"./noop.js";import{C as f}from"./roving-focus-group.js";import{D as m}from"./dom-context.svelte.js";const x=l({component:"avatar",parts:["root","image","fallback"]}),g=new f("Avatar.Root");class ${static create(t){return g.set(new $(t))}opts;domContext;attachment;constructor(t){this.opts=t,this.domContext=new m(this.opts.ref),this.loadImage=this.loadImage.bind(this),this.attachment=c(this.opts.ref)}loadImage(t,s,e){if("loaded"===this.opts.loadingStatus.current)return;let r;const o=new Image;return o.src=t,void 0!==s&&(o.crossOrigin=s),e&&(o.referrerPolicy=e),this.opts.loadingStatus.current="loading",o.onload=()=>{r=this.domContext.setTimeout(()=>{this.opts.loadingStatus.current="loaded"},this.opts.delayMs.current)},o.onerror=()=>{this.opts.loadingStatus.current="error"},()=>{r&&this.domContext.clearTimeout(r)}}#t=t(()=>({id:this.opts.id.current,[x.root]:"","data-status":this.opts.loadingStatus.current,...this.attachment}));get props(){return this.#t()}set props(t){return this.#t(t)}}class v{static create(t){return new v(t,g.get())}opts;root;attachment;constructor(t,s){this.opts=t,this.root=s,this.attachment=c(this.opts.ref),d.pre([()=>this.opts.src.current,()=>this.opts.crossOrigin.current],([t,s])=>{t?this.root.loadImage(t,s,this.opts.referrerPolicy.current):this.root.opts.loadingStatus.current="error"})}#t=t(()=>({id:this.opts.id.current,style:{display:"loaded"===this.root.opts.loadingStatus.current?"block":"none"},"data-status":this.root.opts.loadingStatus.current,[x.image]:"",src:this.opts.src.current,crossorigin:this.opts.crossOrigin.current,referrerpolicy:this.opts.referrerPolicy.current,...this.attachment}));get props(){return this.#t()}set props(t){return this.#t(t)}}class y{static create(t){return new y(t,g.get())}opts;root;attachment;constructor(t,s){this.opts=t,this.root=s,this.attachment=c(this.opts.ref)}#s=t(()=>"loaded"===this.root.opts.loadingStatus.current?{display:"none"}:void 0);get style(){return this.#s()}set style(t){return this.#s(t)}#t=t(()=>({style:this.style,"data-status":this.root.opts.loadingStatus.current,[x.fallback]:"",...this.attachment}));get props(){return this.#t()}set props(t){return this.#t(t)}}function S(t,s){t.component(t=>{let{ref:n=null,class:i,inset:c,children:l,$$slots:p,$$events:u,...h}=s;t.push(`<div${e({"data-slot":"dropdown-menu-label","data-inset":c,class:o(a("px-2 py-1.5 text-sm font-semibold text-right data-[inset]:pr-8",i)),...h})}>`),l?.(t),t.push("\x3c!----\x3e</div>"),r(s,{ref:n})})}function b(t,o){t.component(t=>{let a,{ref:c=null,loadingStatus:l="loading",class:d,$$slots:f,$$events:m,...x}=o,g=!0;function v(t){t.push("\x3c!----\x3e"),function(t,o){t.component(t=>{const n=s(t);let{delayMs:a=0,loadingStatus:i="loading",onLoadingStatusChange:c,child:l,children:d,id:f=p(n),ref:m=null,$$slots:x,$$events:g,...v}=o;const y=$.create({delayMs:u(()=>a),loadingStatus:u(()=>i,t=>{i!==t&&(i=t,c?.(t))}),id:u(()=>f),ref:u(()=>m,t=>m=t)}),S=h(v,y.props);l?(t.push("\x3c!--[--\x3e"),l(t,{props:S}),t.push("\x3c!----\x3e")):(t.push("\x3c!--[!--\x3e"),t.push(`<div${e({...S})}>`),d?.(t),t.push("\x3c!----\x3e</div>")),t.push("\x3c!--]--\x3e"),r(o,{loadingStatus:i,ref:m})})}(t,n([{"data-slot":"avatar",class:i("relative flex size-8 shrink-0 overflow-hidden rounded-full",d)},x,{get ref(){return c},set ref(t){c=t,g=!1},get loadingStatus(){return l},set loadingStatus(t){l=t,g=!1}}])),t.push("\x3c!----\x3e")}do{g=!0,a=t.copy(),v(a)}while(!g);t.subsume(a),r(o,{ref:c,loadingStatus:l})})}function w(t,s){let{$$slots:e,$$events:r,...o}=s;b(t,n([o]))}function j(t,o){t.component(t=>{let a,{ref:c=null,class:l,$$slots:d,$$events:f,...m}=o,x=!0;function g(t){t.push("\x3c!----\x3e"),function(t,o){t.component(t=>{const n=s(t);let{src:a,child:i,id:c=p(n),ref:l=null,crossorigin:d,referrerpolicy:f,$$slots:m,$$events:x,...g}=o;const $=v.create({src:u(()=>a),id:u(()=>c),ref:u(()=>l,t=>l=t),crossOrigin:u(()=>d),referrerPolicy:u(()=>f)}),y=h(g,$.props);i?(t.push("\x3c!--[--\x3e"),i(t,{props:y}),t.push("\x3c!----\x3e")):(t.push("\x3c!--[!--\x3e"),t.push(`<img${e({...y,src:a})} onload="this.__e=event" onerror="this.__e=event"/>`)),t.push("\x3c!--]--\x3e"),r(o,{ref:l})})}(t,n([{"data-slot":"avatar-image",class:i("aspect-square size-full",l)},m,{get ref(){return c},set ref(t){c=t,x=!1}}])),t.push("\x3c!----\x3e")}do{x=!0,a=t.copy(),g(a)}while(!x);t.subsume(a),r(o,{ref:c})})}function k(t,s){let{$$slots:e,$$events:r,...o}=s;j(t,n([o]))}function C(t,o){t.component(t=>{let a,{ref:c=null,class:l,$$slots:d,$$events:f,...m}=o,x=!0;function g(t){t.push("\x3c!----\x3e"),function(t,o){t.component(t=>{const n=s(t);let{children:a,child:i,id:c=p(n),ref:l=null,$$slots:d,$$events:f,...m}=o;const x=y.create({id:u(()=>c),ref:u(()=>l,t=>l=t)}),g=h(m,x.props);i?(t.push("\x3c!--[--\x3e"),i(t,{props:g}),t.push("\x3c!----\x3e")):(t.push("\x3c!--[!--\x3e"),t.push(`<span${e({...g})}>`),a?.(t),t.push("\x3c!----\x3e</span>")),t.push("\x3c!--]--\x3e"),r(o,{ref:l})})}(t,n([{"data-slot":"avatar-fallback",class:i("bg-muted flex size-full items-center justify-center rounded-full",l)},m,{get ref(){return c},set ref(t){c=t,x=!1}}])),t.push("\x3c!----\x3e")}do{x=!0,a=t.copy(),g(a)}while(!x);t.subsume(a),r(o,{ref:c})})}function I(t,s){let{$$slots:e,$$events:r,...o}=s;C(t,n([o]))}export{w as A,S as D,k as a,I as b};
