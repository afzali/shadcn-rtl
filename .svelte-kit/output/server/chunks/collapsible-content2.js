import{v as t,p as e,k as s,m as o,s as n}from"./index.js";import{a as i,b as r,d as p,f as h,g as c,h as a,c as u,m as d}from"./create-id.js";import{w as l,n as f}from"./noop.js";import{C as m,S as g,E as x}from"./roving-focus-group.js";import{N as b}from"./events.js";import{O as $,g as v,h as y}from"./sheet-header.js";const w=p({component:"collapsible",parts:["root","content","trigger"]}),k=new m("Collapsible.Root");class C{static create(t){return k.set(new C(t))}opts;attachment;contentNode=null;contentId=void 0;constructor(t){this.opts=t,this.toggleOpen=this.toggleOpen.bind(this),this.attachment=i(this.opts.ref),new $({ref:r(()=>this.contentNode),open:this.opts.open,onComplete:()=>{this.opts.onOpenChangeComplete.current(this.opts.open.current)}})}toggleOpen(){this.opts.open.current=!this.opts.open.current}#t=t(()=>({id:this.opts.id.current,"data-state":c(this.opts.open.current),"data-disabled":h(this.opts.disabled.current),[w.root]:"",...this.attachment}));get props(){return this.#t()}set props(t){return this.#t(t)}}class D{static create(t){return new D(t,k.get())}opts;root;attachment;#e=t(()=>this.opts.hiddenUntilFound.current?this.root.opts.open.current:this.opts.forceMount.current||this.root.opts.open.current);get present(){return this.#e()}set present(t){return this.#e(t)}#s;#o=!1;#n=0;#i=0;constructor(t,e){this.opts=t,this.root=e,this.#o=e.opts.open.current,this.root.contentId=this.opts.id.current,this.attachment=i(this.opts.ref,t=>this.root.contentNode=t),l.pre(()=>this.opts.id.current,t=>{this.root.contentId=t}),l.pre([()=>this.opts.ref.current,()=>this.opts.hiddenUntilFound.current],([t,e])=>{if(!t||!e)return;return b(t,"beforematch",()=>{this.root.opts.open.current||requestAnimationFrame(()=>{this.root.opts.open.current=!0})})}),l([()=>this.opts.ref.current,()=>this.present],([t])=>{t&&v(()=>{if(!this.opts.ref.current)return;this.#s=this.#s||{transitionDuration:t.style.transitionDuration,animationName:t.style.animationName},t.style.transitionDuration="0s",t.style.animationName="none";const e=t.getBoundingClientRect();if(this.#i=e.height,this.#n=e.width,!this.#o){const{animationName:e,transitionDuration:s}=this.#s;t.style.transitionDuration=s,t.style.animationName=e}})})}#r=t(()=>({open:this.root.opts.open.current}));get snippetProps(){return this.#r()}set snippetProps(t){return this.#r(t)}#t=t(()=>({id:this.opts.id.current,style:{"--bits-collapsible-content-height":this.#i?`${this.#i}px`:void 0,"--bits-collapsible-content-width":this.#n?`${this.#n}px`:void 0},hidden:this.opts.hiddenUntilFound.current&&!this.root.opts.open.current?"until-found":void 0,"data-state":c(this.root.opts.open.current),"data-disabled":h(this.root.opts.disabled.current),[w.content]:"",...this.attachment}));get props(){return this.#t()}set props(t){return this.#t(t)}}class O{static create(t){return new O(t,k.get())}opts;root;attachment;#p=t(()=>this.opts.disabled.current||this.root.opts.disabled.current);constructor(t,e){this.opts=t,this.root=e,this.attachment=i(this.opts.ref),this.onclick=this.onclick.bind(this),this.onkeydown=this.onkeydown.bind(this)}onclick(t){if(!this.#p())return 0!==t.button?t.preventDefault():void this.root.toggleOpen()}onkeydown(t){this.#p()||t.key!==g&&t.key!==x||(t.preventDefault(),this.root.toggleOpen())}#t=t(()=>({id:this.opts.id.current,type:"button",disabled:this.#p(),"aria-controls":this.root.contentId,"aria-expanded":a(this.root.opts.open.current),"data-state":c(this.root.opts.open.current),"data-disabled":h(this.#p()),[w.trigger]:"",onclick:this.onclick,onkeydown:this.onkeydown,...this.attachment}));get props(){return this.#t()}set props(t){return this.#t(t)}}function N(t,i){t.component(t=>{let p,{ref:h=null,open:c=!1,$$slots:a,$$events:l,...m}=i,g=!0;function x(t){t.push("\x3c!----\x3e"),function(t,n){t.component(t=>{const i=e(t);let{children:p,child:h,id:c=u(i),ref:a=null,open:l=!1,disabled:m=!1,onOpenChange:g=f,onOpenChangeComplete:x=f,$$slots:b,$$events:$,...v}=n;const y=C.create({open:r(()=>l,t=>{l=t,g(t)}),disabled:r(()=>m),id:r(()=>c),ref:r(()=>a,t=>a=t),onOpenChangeComplete:r(()=>x)}),w=d(v,y.props);h?(t.push("\x3c!--[--\x3e"),h(t,{props:w}),t.push("\x3c!----\x3e")):(t.push("\x3c!--[!--\x3e"),t.push(`<div${s({...w})}>`),p?.(t),t.push("\x3c!----\x3e</div>")),t.push("\x3c!--]--\x3e"),o(n,{ref:a,open:l})})}(t,n([{"data-slot":"collapsible"},m,{get ref(){return h},set ref(t){h=t,g=!1},get open(){return c},set open(t){c=t,g=!1}}])),t.push("\x3c!----\x3e")}do{g=!0,p=t.copy(),x(p)}while(!g);t.subsume(p),o(i,{ref:h,open:c})})}function P(t,i){t.component(t=>{let p,{ref:h=null,$$slots:c,$$events:a,...l}=i,f=!0;function m(t){t.push("\x3c!----\x3e"),function(t,n){t.component(t=>{const i=e(t);let{children:p,child:h,ref:c=null,id:a=u(i),disabled:l=!1,$$slots:f,$$events:m,...g}=n;const x=O.create({id:r(()=>a),ref:r(()=>c,t=>c=t),disabled:r(()=>l)}),b=d(g,x.props);h?(t.push("\x3c!--[--\x3e"),h(t,{props:b}),t.push("\x3c!----\x3e")):(t.push("\x3c!--[!--\x3e"),t.push(`<button${s({...b})}>`),p?.(t),t.push("\x3c!----\x3e</button>")),t.push("\x3c!--]--\x3e"),o(n,{ref:c})})}(t,n([{"data-slot":"collapsible-trigger"},l,{get ref(){return h},set ref(t){h=t,f=!1}}])),t.push("\x3c!----\x3e")}do{f=!0,p=t.copy(),m(p)}while(!f);t.subsume(p),o(i,{ref:h})})}function M(t,i){t.component(t=>{let p,{ref:h=null,$$slots:c,$$events:a,...l}=i,f=!0;function m(t){t.push("\x3c!----\x3e"),function(t,n){t.component(t=>{const i=e(t);let{child:p,ref:h=null,forceMount:c=!1,hiddenUntilFound:a=!1,children:l,id:f=u(i),$$slots:m,$$events:g,...x}=n;const b=D.create({id:r(()=>f),forceMount:r(()=>c),hiddenUntilFound:r(()=>a),ref:r(()=>h,t=>h=t)});{let e=function(t,{present:e}){const o=d(x,b.props,a&&!e?{}:{hidden:a?!e:c?void 0:!e});p?(t.push("\x3c!--[--\x3e"),p(t,{...b.snippetProps,props:o}),t.push("\x3c!----\x3e")):(t.push("\x3c!--[!--\x3e"),t.push(`<div${s({...o})}>`),l?.(t),t.push("\x3c!----\x3e</div>")),t.push("\x3c!--]--\x3e")};y(t,{forceMount:!0,open:b.present,ref:b.opts.ref,presence:e})}o(n,{ref:h})})}(t,n([{"data-slot":"collapsible-content"},l,{get ref(){return h},set ref(t){h=t,f=!1}}])),t.push("\x3c!----\x3e")}do{f=!0,p=t.copy(),m(p)}while(!f);t.subsume(p),o(i,{ref:h})})}export{N as C,M as a,P as b};
