import{B as e}from"./chunks/false.js";import{json as t,text as r,error as s}from"@sveltejs/kit";import{HttpError as n,SvelteKitError as a,Redirect as o,ActionFailure as i}from"@sveltejs/kit/internal";import{with_request_store as c,merge_tracing as l,try_get_request_store as u}from"@sveltejs/kit/internal/server";import{a as d,b as p,c as h,r as f,o as m,d as _}from"./chunks/environment.js";import*as y from"devalue";import{m as g,d as w,a as v,S as $,r as b,w as k,v as E,b as j,c as x,e as R,n as q,f as S,g as O,h as T}from"./chunks/exports.js";import{b as A,t as P,a as U,g as C}from"./chunks/utils.js";import{p as H,r as N,o as z,s as L,a as I,g as W,b as D}from"./chunks/internal.js";import{c as M,p as F,s as G,T as J,I as B}from"./chunks/shared.js";import{parse as V,serialize as Q}from"cookie";import*as X from"set-cookie-parser";const Y=[101,103,204,205,304],Z=!!globalThis.process?.versions?.webcontainer,K=["GET","POST","PUT","PATCH","DELETE","OPTIONS","HEAD"],ee=["GET","POST","HEAD"];function te(e,t){const r=[];let s;e.split(",").forEach((e,t)=>{const s=/([^/ \t]+)\/([^; \t]+)[ \t]*(?:;[ \t]*q=([0-9.]+))?/.exec(e);if(s){const[,e,n,a="1"]=s;r.push({type:e,subtype:n,q:+a,i:t})}}),r.sort((e,t)=>e.q!==t.q?t.q-e.q:"*"===e.subtype!=("*"===t.subtype)?"*"===e.subtype?1:-1:"*"===e.type!=("*"===t.type)?"*"===e.type?1:-1:e.i-t.i);let n=1/0;for(const a of t){const[e,t]=a.split("/"),o=r.findIndex(r=>!(r.type!==e&&"*"!==r.type||r.subtype!==t&&"*"!==r.subtype));-1!==o&&o<n&&(s=a,n=o)}return s}function re(e){return function(e,...t){const r=e.headers.get("content-type")?.split(";",1)[0].trim()??"";return t.includes(r.toLowerCase())}(e,"application/x-www-form-urlencoded","multipart/form-data","text/plain")}function se(e){return e}function ne(e){return e instanceof n||e instanceof a?e.status:500}const ae={"&":"&amp;",'"':"&quot;"},oe={"&":"&amp;","<":"&lt;"},ie="[\\ud800-\\udbff](?![\\udc00-\\udfff])|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\udc00-\\udfff]",ce=new RegExp(`[${Object.keys(ae).join("")}]|`+ie,"g"),le=new RegExp(`[${Object.keys(oe).join("")}]|`+ie,"g");function ue(e,t){const r=t?ae:oe;return e.replace(t?ce:le,e=>2===e.length?e:r[e]??`&#${e.charCodeAt(0)};`)}function de(e,t){return r(`${t} method not allowed`,{status:405,headers:{allow:pe(e).join(", ")}})}function pe(e){const t=K.filter(t=>t in e);return"GET"in e&&!("HEAD"in e)&&t.push("HEAD"),t}function he(e){return`__sveltekit_${e.version_hash}`}function fe(e,t,s){let n=e.templates.error({status:t,message:ue(s)});return r(n,{headers:{"content-type":"text/html; charset=utf-8"},status:t})}async function me(e,r,s,a){var o;const i=ne(a=a instanceof n?a:(o=a)instanceof Error||o&&o.name&&o.message?o:new Error(JSON.stringify(o))),c=await _e(e,r,s,a),l=te(e.request.headers.get("accept")||"text/html",["application/json","text/html"]);return e.isDataRequest||"application/json"===l?t(c,{status:i}):fe(s,i,c.message)}async function _e(e,t,r,s){if(s instanceof n)return{message:"Unknown Error",...s.body};const o=ne(s),i=function(e){return e instanceof a?e.text:"Internal Error"}(s);return await c({event:e,state:t},()=>r.hooks.handleError({error:s,event:e,status:o,message:i}))??{message:i}}function ye(e,t){return new Response(void 0,{status:e,headers:{location:t}})}function ge(e,t){return t.path?`Data returned from \`load\` while rendering ${e.route.id} is not serializable: ${t.message} (${t.path}). If you need to serialize/deserialize custom types, use transport hooks: https://svelte.dev/docs/kit/hooks#Universal-hooks-transport.`:""===t.path?`Data returned from \`load\` while rendering ${e.route.id} is not a plain object`:t.message}function we(e){const t={};return e.uses&&e.uses.dependencies.size>0&&(t.dependencies=Array.from(e.uses.dependencies)),e.uses&&e.uses.search_params.size>0&&(t.search_params=Array.from(e.uses.search_params)),e.uses&&e.uses.params.size>0&&(t.params=Array.from(e.uses.params)),e.uses?.parent&&(t.parent=1),e.uses?.route&&(t.route=1),e.uses?.url&&(t.url=1),t}function ve(e,t){return e._.prerendered_routes.has(t)||"/"===t.at(-1)&&e._.prerendered_routes.has(t.slice(0,-1))}function $e(e){const t=e?.split("/"),r=t?.at(-1);if(!r)return"unknown";return r.split(".").slice(0,-1).join(".")}function be(e){return e.filter(e=>null!=e)}const ke="/__data.json",Ee=".html__data.json";function je(e){return e.endsWith(".html")?e.replace(/\.html$/,Ee):e.replace(/\/$/,"")+ke}const xe="/__route.js";function Re(e){return e.replace(/\/$/,"")+xe}const qe={spanContext:()=>Se,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this},addLink(){return this},addLinks(){return this}},Se={traceId:"",spanId:"",traceFlags:0};async function Oe({name:e,attributes:t,fn:r}){return r(qe)}function Te(e){return"application/json"===te(e.request.headers.get("accept")??"*/*",["application/json","text/html"])&&"POST"===e.request.method}function Ae(e){return e instanceof i?new Error('Cannot "throw fail()". Use "return fail()"'):e}function Pe(e){return Ue({type:"redirect",status:e.status,location:e.location})}function Ue(e,r){return t(e,r)}function Ce(e){if(e.default&&Object.keys(e).length>1)throw new Error("When using named actions, the default action cannot be used. See the docs for more info: https://svelte.dev/docs/kit/form-actions#named-actions")}async function He(e,t,r){const s=new URL(e.request.url);let n="default";for(const a of s.searchParams)if(a[0].startsWith("/")){if(n=a[0].slice(1),"default"===n)throw new Error('Cannot use reserved action name "default"');break}const o=r[n];if(!o)throw new a(404,"Not Found",`No action with name '${n}' found`);if(!re(e.request))throw new a(415,"Unsupported Media Type",`Form actions expect form-encoded data — received ${e.request.headers.get("content-type")}`);return Oe({name:"sveltekit.form_action",attributes:{"http.route":e.route.id||"unknown"},fn:async r=>{const s=l(e,r),n=await c({event:s,state:t},()=>o(s));return n instanceof i&&r.setAttributes({"sveltekit.form_action.result.type":"failure","sveltekit.form_action.result.status":n.status}),n}})}function Ne(e,t,r){const s=Object.fromEntries(Object.entries(r).map(([e,t])=>[e,t.encode]));return ze(e,e=>y.stringify(e,s),t)}function ze(e,t,r){try{return t(e)}catch(s){const t=s;if(e instanceof Response)throw new Error(`Data returned from action inside ${r} is not serializable. Form actions need to return plain objects or fail(). E.g. return { success: true } or return fail(400, { message: "invalid" });`);if("path"in t){let e=`Data returned from action inside ${r} is not serializable: ${t.message}`;throw""!==t.path&&(e+=` (data.${t.path})`),new Error(e)}throw t}}function Le(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),fulfil:e,reject:t}}function Ie(){let e=0;const t=[Le()];return{iterate:(e=e=>e)=>({[Symbol.asyncIterator]:()=>({next:async()=>{const r=await t[0].promise;return r.done?r:(t.shift(),{value:e(r.value),done:!1})}})}),add:r=>{e+=1,r.then(r=>{t[t.length-1].fulfil({value:r,done:!1}),t.push(Le()),0===--e&&t[t.length-1].fulfil({done:!0})})}}}function We(e,t,r){let s=1,n=-1;const a=Ie(),o=he(r);const i=[];return{set_max_nodes(e){n=e},add_node(n,c){try{if(!c)return void(i[n]="null");const u={type:"data",data:c.data,uses:we(c)};c.slash&&(u.slash=c.slash),i[n]=y.uneval(u,(l=n,function n(i){if("function"==typeof i?.then){const c=s++,u=i.then(e=>({data:e})).catch(async s=>({error:await _e(e,t,r,s)})).then(async({data:s,error:a})=>{let i;try{i=y.uneval(a?[,a]:[s],n)}catch{a=await _e(e,t,r,new Error(`Failed to serialize promise while rendering ${e.route.id}`)),s=void 0,i=y.uneval([,a],n)}return{index:l,str:`${o}.resolve(${c}, ${i.includes("app.decode")?`(app) => ${i}`:`() => ${i}`})`}});return a.add(u),`${o}.defer(${c})`}for(const e in r.hooks.transport){const t=r.hooks.transport[e].encode(i);if(t)return`app.decode('${e}', ${y.uneval(t,n)})`}}))}catch(u){throw u.path=u.path.slice(1),new Error(ge(e,u))}var l},get_data(e){const t=`<script${e.script_needs_nonce?` nonce="${e.nonce}"`:""}>`;return{data:`[${be(n>-1?i.slice(0,n):i).join(",")}]`,chunks:s>1?a.iterate(({index:e,str:r})=>n>-1&&e>=n?"":t+r+"<\/script>\n"):null}}}}function De(e,t,r){let s=1;const n=Ie(),a={...Object.fromEntries(Object.entries(r.hooks.transport).map(([e,t])=>[e,t.encode])),Promise:o=>{if("function"!=typeof o?.then)return;const i=s++;let c="data";const l=o.catch(async s=>(c="error",_e(e,t,r,s))).then(async s=>{let n;try{n=y.stringify(s,a)}catch{const s=await _e(e,t,r,new Error(`Failed to serialize promise while rendering ${e.route.id}`));c="error",n=y.stringify(s,a)}return`{"type":"chunk","id":${i},"${c}":${n}}\n`});return n.add(l),i}},o=[];return{add_node(t,r){try{if(!r)return void(o[t]="null");if("error"===r.type||"skip"===r.type)return void(o[t]=JSON.stringify(r));o[t]=`{"type":"data","data":${y.stringify(r.data,a)},"uses":${JSON.stringify(we(r))}${r.slash?`,"slash":${JSON.stringify(r.slash)}`:""}}`}catch(s){throw s.path="data"+s.path,new Error(ge(e,s))}},get_data:()=>({data:`{"type":"data","nodes":[${o.join(",")}]}\n`,chunks:s>1?n.iterate():null})}}async function Me({event:e,event_state:t,state:r,node:s,parent:n}){if(!s?.server)return null;let a=!0;const o={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},i=s.server.load,u=s.server.trailingSlash;if(!i)return{type:"data",data:null,uses:o,slash:u};const d=g(e.url,()=>{a&&(o.url=!0)},e=>{a&&o.search_params.add(e)});r.prerendering&&w(d);return{type:"data",data:await Oe({name:"sveltekit.load",attributes:{"sveltekit.load.node_id":s.server_id||"unknown","sveltekit.load.node_type":$e(s.server_id),"http.route":e.route.id||"unknown"},fn:async r=>{const s=l(e,r);return await c({event:s,state:t},()=>i.call(null,{...s,fetch:(t,r)=>(new URL(t instanceof Request?t.url:t,e.url),e.fetch(t,r)),depends:(...t)=>{for(const r of t){const{href:t}=new URL(r,e.url);o.dependencies.add(t)}},params:new Proxy(e.params,{get:(e,t)=>(a&&o.params.add(t),e[t])}),parent:async()=>(a&&(o.parent=!0),n()),route:new Proxy(e.route,{get:(e,t)=>(a&&(o.route=!0),e[t])}),url:d,untrack(e){a=!1;try{return e()}finally{a=!0}}}))}})??null,uses:o,slash:u}}async function Fe({event:e,event_state:t,fetched:r,node:s,parent:n,server_data_promise:a,state:o,resolve_opts:i,csr:u}){const d=await a,p=s?.universal?.load;if(!p)return d?.data??null;return await Oe({name:"sveltekit.load",attributes:{"sveltekit.load.node_id":s.universal_id||"unknown","sveltekit.load.node_type":$e(s.universal_id),"http.route":e.route.id||"unknown"},fn:async s=>{const a=l(e,s);return await c({event:a,state:t},()=>p.call(null,{url:e.url,params:e.params,data:d?.data??null,route:e.route,fetch:Ge(e,o,r,u,i),setHeaders:e.setHeaders,depends:()=>{},parent:n,untrack:e=>e(),tracing:a.tracing}))}})??null}function Ge(e,t,r,s,n){return(a,o)=>{const i=(async(a,o)=>{const i=a instanceof Request&&a.body?a.clone().body:null,c=a instanceof Request&&[...a.headers].length?new Headers(a.headers):o?.headers;let l=await e.fetch(a,o);const u=new URL(a instanceof Request?a.url:a,e.url),d=u.origin===e.url.origin;let p,h;if(d)t.prerendering&&(p={response:l,body:null},t.prerendering.dependencies.set(u.pathname,p));else if("https:"===u.protocol||"http:"===u.protocol)if("no-cors"===(a instanceof Request?a.mode:o?.mode??"cors"))l=new Response("",{status:l.status,statusText:l.statusText,headers:l.headers});else{const t=l.headers.get("access-control-allow-origin");if(!t||t!==e.url.origin&&"*"!==t)throw new Error(`CORS error: ${t?"Incorrect":"No"} 'Access-Control-Allow-Origin' header is present on the requested resource`)}const f=new Proxy(l,{get(t,s,n){async function l(s,n){const l=Number(t.status);if(isNaN(l))throw new Error(`response.status is not a number. value: "${t.status}" type: ${typeof t.status}`);r.push({url:d?u.href.slice(e.url.origin.length):u.href,method:e.request.method,request_body:a instanceof Request&&i?await Je(i):o?.body,request_headers:c,response_body:s,response:t,is_b64:n})}if("body"===s){if(null===t.body)return null;if(h)return h;const[e,r]=t.body.tee();return(async()=>{let t=new Uint8Array;for await(const r of e){const e=new Uint8Array(t.length+r.length);e.set(t,0),e.set(r,t.length),t=e}p&&(p.body=new Uint8Array(t)),l(A(t),!0)})(),h=r}if("arrayBuffer"===s)return async()=>{const e=await t.arrayBuffer(),r=new Uint8Array(e);return p&&(p.body=r),e instanceof ArrayBuffer&&await l(A(r),!0),e};async function f(){const e=await t.text();if(""!==e||!Y.includes(t.status))return e&&"string"!=typeof e||await l(e,!1),p&&(p.body=e),e;await l(void 0,!1)}return"text"===s?f:"json"===s?async()=>{const e=await f();return e?JSON.parse(e):void 0}:Reflect.get(t,s,t)}});if(s){const t=l.headers.get;l.headers.get=r=>{const s=r.toLowerCase(),a=t.call(l.headers,s);if(a&&!s.startsWith("x-sveltekit-")&&!n.filterSerializedResponseHeaders(s,a))throw new Error(`Failed to get response header "${s}" — it must be included by the \`filterSerializedResponseHeaders\` option: https://svelte.dev/docs/kit/hooks#Server-hooks-handle (at ${e.route.id})`);return a}}return f})(a,o);return i.catch(()=>{}),i}}async function Je(e){let t="";const r=e.getReader();for(;;){const{done:e,value:s}=await r.read();if(e)break;t+=P.decode(s)}return t}function Be(...e){let t=5381;for(const r of e)if("string"==typeof r){let e=r.length;for(;e;)t=33*t^r.charCodeAt(--e)}else{if(!ArrayBuffer.isView(r))throw new TypeError("value must be a string or TypedArray");{const e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);let s=e.length;for(;s;)t=33*t^e[--s]}}return(t>>>0).toString(36)}const Ve={"<":"\\u003C","\u2028":"\\u2028","\u2029":"\\u2029"},Qe=new RegExp(`[${Object.keys(Ve).join("")}]`,"g");const Xe=JSON.stringify;function Ye(e){Ke[0]||function(){function e(e){return 4294967296*(e-Math.floor(e))}let t=2;for(let r=0;r<64;t++){let s=!0;for(let e=2;e*e<=t;e++)if(t%e===0){s=!1;break}s&&(r<8&&(Ze[r]=e(t**.5)),Ke[r]=e(t**(1/3)),r++)}}();const t=Ze.slice(0),r=function(e){const t=U.encode(e),r=8*t.length,s=512*Math.ceil((r+65)/512),n=new Uint8Array(s/8);n.set(t),n[t.length]=128,et(n);const a=new Uint32Array(n.buffer);return a[a.length-2]=Math.floor(r/4294967296),a[a.length-1]=r,a}(e);for(let n=0;n<r.length;n+=16){const e=r.subarray(n,n+16);let s,a,o,i=t[0],c=t[1],l=t[2],u=t[3],d=t[4],p=t[5],h=t[6],f=t[7];for(let t=0;t<64;t++)t<16?s=e[t]:(a=e[t+1&15],o=e[t+14&15],s=e[15&t]=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+e[15&t]+e[t+9&15]|0),s=s+f+(d>>>6^d>>>11^d>>>25^d<<26^d<<21^d<<7)+(h^d&(p^h))+Ke[t],f=h,h=p,p=d,d=u+s|0,u=l,l=c,c=i,i=s+(c&l^u&(c^l))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;t[0]=t[0]+i|0,t[1]=t[1]+c|0,t[2]=t[2]+l|0,t[3]=t[3]+u|0,t[4]=t[4]+d|0,t[5]=t[5]+p|0,t[6]=t[6]+h|0,t[7]=t[7]+f|0}const s=new Uint8Array(t.buffer);return et(s),btoa(String.fromCharCode(...s))}const Ze=new Uint32Array(8),Ke=new Uint32Array(64);function et(e){for(let t=0;t<e.length;t+=4){const r=e[t+0],s=e[t+1],n=e[t+2],a=e[t+3];e[t+0]=a,e[t+1]=n,e[t+2]=s,e[t+3]=r}}const tt=new Uint8Array(16);const rt=new Set(["self","unsafe-eval","unsafe-hashes","unsafe-inline","none","strict-dynamic","report-sample","wasm-unsafe-eval","script"]),st=/^(nonce|sha\d\d\d)-/;class nt{#e;#t;#r;#s;#n;#a;#o;#i;#c;#l;#u;#d;#p;#h;#f;constructor(e,t,r){this.#e=e,this.#c=t;const s=this.#c;this.#l=[],this.#u=[],this.#d=[],this.#p=[],this.#h=[];const n=s["script-src"]||s["default-src"],a=s["script-src-elem"],o=s["style-src"]||s["default-src"],i=s["style-src-attr"],c=s["style-src-elem"],l=e=>!!e&&!e.some(e=>"unsafe-inline"===e);this.#r=l(n),this.#s=l(a),this.#a=l(o),this.#o=l(i),this.#i=l(c),this.#t=this.#r||this.#s,this.#n=this.#a||this.#o||this.#i,this.script_needs_nonce=this.#t&&!this.#e,this.style_needs_nonce=this.#n&&!this.#e,this.#f=r}add_script(e){if(!this.#t)return;const t=this.#e?`sha256-${Ye(e)}`:`nonce-${this.#f}`;this.#r&&this.#l.push(t),this.#s&&this.#u.push(t)}add_style(e){if(!this.#n)return;const t=this.#e?`sha256-${Ye(e)}`:`nonce-${this.#f}`;if(this.#a&&this.#d.push(t),this.#o&&this.#p.push(t),this.#i){const e="sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=",r=this.#c;!r["style-src-elem"]||r["style-src-elem"].includes(e)||this.#h.includes(e)||this.#h.push(e),t!==e&&this.#h.push(t)}}get_header(e=!1){const t=[],r={...this.#c};this.#d.length>0&&(r["style-src"]=[...r["style-src"]||r["default-src"]||[],...this.#d]),this.#p.length>0&&(r["style-src-attr"]=[...r["style-src-attr"]||[],...this.#p]),this.#h.length>0&&(r["style-src-elem"]=[...r["style-src-elem"]||[],...this.#h]),this.#l.length>0&&(r["script-src"]=[...r["script-src"]||r["default-src"]||[],...this.#l]),this.#u.length>0&&(r["script-src-elem"]=[...r["script-src-elem"]||[],...this.#u]);for(const s in r){if(e&&("frame-ancestors"===s||"report-uri"===s||"sandbox"===s))continue;const n=r[s];if(!n)continue;const a=[s];Array.isArray(n)&&n.forEach(e=>{rt.has(e)||st.test(e)?a.push(`'${e}'`):a.push(e)}),t.push(a.join(" "))}return t.join("; ")}}class at extends nt{get_meta(){const e=this.get_header(!0);if(e)return`<meta http-equiv="content-security-policy" content="${ue(e,!0)}">`}}class ot extends nt{constructor(e,t,r){if(super(e,t,r),Object.values(t).filter(e=>!!e).length>0){const e=t["report-to"]?.length??!1,r=t["report-uri"]?.length??!1;if(!e&&!r)throw Error("`content-security-policy-report-only` must be specified with either the `report-to` or `report-uri` directives, or both")}}}class it{nonce=function(){return crypto.getRandomValues(tt),btoa(String.fromCharCode(...tt))}();csp_provider;report_only_provider;constructor({mode:e,directives:t,reportOnly:r},{prerender:s}){const n="hash"===e||"auto"===e&&s;this.csp_provider=new at(n,t,this.nonce),this.report_only_provider=new ot(n,r,this.nonce)}get script_needs_nonce(){return this.csp_provider.script_needs_nonce||this.report_only_provider.script_needs_nonce}get style_needs_nonce(){return this.csp_provider.style_needs_nonce||this.report_only_provider.style_needs_nonce}add_script(e){this.csp_provider.add_script(e),this.report_only_provider.add_script(e)}add_style(e){this.csp_provider.add_style(e),this.report_only_provider.add_style(e)}}function ct(e,t,r){const s={},n=e.slice(1),a=n.filter(e=>void 0!==e);let o=0;for(let i=0;i<t.length;i+=1){const e=t[i];let c=n[i-o];if(e.chained&&e.rest&&o&&(c=n.slice(i-o,i+1).filter(e=>e).join("/"),o=0),void 0!==c){if(!e.matcher||r[e.matcher](c)){s[e.name]=c;const r=t[i+1],l=n[i+1];r&&!r.rest&&r.optional&&l&&e.chained&&(o=0),r||l||Object.keys(s).length!==a.length||(o=0);continue}if(!e.optional||!e.chained)return;o++}else e.rest&&(s[e.name]="")}if(!o)return s}function lt(e,t,r){const{errors:s,layouts:n,leaf:a}=e,o=[...s,...n.map(e=>e?.[1]),a[1]].filter(e=>"number"==typeof e).map(e=>`'${e}': () => ${ut(r._.client.nodes?.[e],t)}`).join(",\n\t\t");return[`{\n\tid: ${Xe(e.id)}`,`errors: ${Xe(e.errors)}`,`layouts: ${Xe(e.layouts)}`,`leaf: ${Xe(e.leaf)}`,`nodes: {\n\t\t${o}\n\t}\n}`].join(",\n\t")}function ut(e,t){if(!e)return"Promise.resolve({})";if("/"===e[0])return`import('${e}')`;if(""!==d)return`import('${d}/${e}')`;let r=C(t.pathname,`${p}/${e}`);return"."!==r[0]&&(r=`./${r}`),`import('${r}')`}function dt(e,t,s,n){const a=new Headers({"content-type":"application/javascript; charset=utf-8"});if(e){const o=lt(e,s,n),i=`${function(e,t,r){const{errors:s,layouts:n,leaf:a}=e;let o="";for(const i of[...s,...n.map(e=>e?.[1]),a[1]]){if("number"!=typeof i)continue;const e=r._.client.css?.[i];for(const t of e??[])o+=`'${d||p}/${t}',`}return o?`${ut(r._.client.start,t)}.then(x => x.load_css([${o}]));`:""}(e,s,n)}\nexport const route = ${o}; export const params = ${JSON.stringify(t)};`;return{response:r(i,{headers:a}),body:i}}return{response:r("",{headers:a}),body:""}}const pt={...b(!1),check:()=>!1};async function ht({branch:e,fetched:t,options:s,manifest:n,state:a,page_config:o,status:i,error:l=null,event:u,event_state:g,resolve_opts:w,action_result:v,data_serializer:$}){if(a.prerendering){if("nonce"===s.csp.mode)throw new Error('Cannot use prerendering if config.kit.csp.mode === "nonce"');if(s.app_template_contains_nonce)throw new Error("Cannot use prerendering if page template contains %sveltekit.nonce%")}const{client:b}=n._,E=new Set(b.imports),j=new Set(b.stylesheets),x=new Set(b.fonts),R=new Set,q=new Set,S=new Map;let O;const T="success"===v?.type||"failure"===v?.type?v.data??null:null;let A=p,P=d,C=Xe(p);if(a.prerendering?.fallback)s.hash_routing&&(C="new URL('.', location).pathname.slice(0, -1)");else{const e=u.url.pathname.slice(p.length).split("/").slice(2);A=e.map(()=>"..").join("/")||".",C=`new URL(${Xe(A)}, location).pathname.slice(0, -1)`,(!d||"/"===d[0]&&"/_svelte_kit_assets"!==d)&&(P=A)}if(o.ssr){const t={stores:{page:k(null),navigating:k(null),updated:pt},constructors:await Promise.all(e.map(({node:e})=>{if(!e.component)throw new Error(`Missing +page.svelte component for route ${u.route.id}`);return e.component()})),form:T};let r={};for(let s=0;s<e.length;s+=1)r={...r,...e[s].data},t[`data_${s}`]=r;t.page={error:l,params:u.params,route:u.route,status:i,url:u.url,data:r,form:T,state:{}};const n={context:new Map([["__request__",{page:t.page}]])};globalThis.fetch;try{O=await c({event:u,state:g},async()=>{f&&m({base:A,assets:P});const e=s.root.render(t,n),r=s.async&&"then"in e?e.then(e=>e):e;s.async&&_();const{head:a,html:o,css:i}=s.async?await r:r;return{head:a,html:o,css:i}})}finally{_()}for(const{node:s}of e){for(const e of s.imports)E.add(e);for(const e of s.stylesheets)j.add(e);for(const e of s.fonts)x.add(e);s.inline_styles&&!b.inline&&Object.entries(await s.inline_styles()).forEach(([e,t])=>S.set(e,t))}}else O={head:"",html:"",css:{code:"",map:null}};let N="",z=O.html;const L=new it(s.csp,{prerender:!!a.prerendering}),I=e=>e.startsWith("/")?p+e:`${P}/${e}`,W=b.inline?b.inline?.style:Array.from(S.values()).join("\n");if(W){const e=[];L.style_needs_nonce&&e.push(` nonce="${L.nonce}"`),L.add_style(W),N+=`\n\t<style${e.join("")}>${W}</style>`}for(const r of j){const e=I(r),t=['rel="stylesheet"'];S.has(r)?t.push("disabled",'media="(max-width: 0)"'):w.preload({type:"css",path:e})&&R.add(`<${encodeURI(e)}>; rel="preload"; as="style"; nopush`),N+=`\n\t\t<link href="${e}" ${t.join(" ")}>`}for(const r of x){const e=I(r);if(w.preload({type:"font",path:e})){const t=r.slice(r.lastIndexOf(".")+1);q.add(`<link rel="preload" as="font" type="font/${t}" href="${e}" crossorigin>`),R.add(`<${encodeURI(e)}>; rel="preload"; as="font"; type="font/${t}"; crossorigin; nopush`)}}const D=he(s),{data:F,chunks:G}=$.get_data(L);if(o.ssr&&o.csr&&(z+=`\n\t\t\t${t.map(e=>function(e,t,r=!1){const s={};let n=null,a=null,o=!1;for(const[u,d]of e.response.headers)t(u,d)&&(s[u]=d),"cache-control"===u?n=d:"age"===u?a=d:"vary"===u&&"*"===d.trim()&&(o=!0);const i={status:e.response.status,statusText:e.response.statusText,headers:s,body:e.response_body},c=JSON.stringify(i).replace(Qe,e=>Ve[e]),l=['type="application/json"',"data-sveltekit-fetched",`data-url="${ue(e.url,!0)}"`];if(e.is_b64&&l.push("data-b64"),e.request_headers||e.request_body){const t=[];e.request_headers&&t.push([...new Headers(e.request_headers)].join(",")),e.request_body&&t.push(e.request_body),l.push(`data-hash="${Be(...t)}"`)}if(!r&&"GET"===e.method&&n&&!o){const e=/s-maxage=(\d+)/g.exec(n)??/max-age=(\d+)/g.exec(n);if(e){const t=+e[1]-+(a??"0");l.push(`data-ttl="${t}"`)}}return`<script ${l.join(" ")}>${c}<\/script>`}(e,w.filterSerializedResponseHeaders,!!a.prerendering)).join("\n\t\t\t")}`),o.csr){const t=n._.client.routes?.find(e=>e.id===u.route.id)??null;if(b.uses_env_dynamic_public&&a.prerendering&&E.add(`${h}/env.js`),!b.inline){const e=Array.from(E,e=>I(e)).filter(e=>w.preload({type:"js",path:e}));for(const t of e)R.add(`<${encodeURI(t)}>; rel="modulepreload"; nopush`),"modulepreload"!==s.preload_strategy?N+=`\n\t\t<link rel="preload" as="script" crossorigin="anonymous" href="${t}">`:q.add(`<link rel="modulepreload" href="${t}">`)}if(a.prerendering&&q.size>0&&(N+=Array.from(q).map(e=>`\n\t\t${e}`).join("")),n._.client.routes&&a.prerendering&&!a.prerendering.fallback){const e=Re(u.url.pathname);a.prerendering.dependencies.set(e,dt(t,u.params,new URL(e,u.url),n))}const r=[],c=b.uses_env_dynamic_public&&a.prerendering,p=[`base: ${C}`];if(d&&p.push(`assets: ${Xe(d)}`),b.uses_env_dynamic_public&&p.push(`env: ${c?"null":Xe(H)}`),G){r.push("const deferred = new Map();"),p.push("defer: (id) => new Promise((fulfil, reject) => {\n\t\t\t\t\t\t\tdeferred.set(id, { fulfil, reject });\n\t\t\t\t\t\t})");let e="";Object.keys(s.hooks.transport).length>0&&(e=b.inline?`const app = __sveltekit_${s.version_hash}.app.app;`:b.app?`const app = await import(${Xe(I(b.app))});`:`const { app } = await import(${Xe(I(b.start))});`);const t=e?`${e}\n\t\t\t\t\t\t\tconst [data, error] = fn(app);`:"const [data, error] = fn();";p.push(`resolve: async (id, fn) => {\n\t\t\t\t\t\t\t${t}\n\n\t\t\t\t\t\t\tconst try_to_resolve = () => {\n\t\t\t\t\t\t\t\tif (!deferred.has(id)) {\n\t\t\t\t\t\t\t\t\tsetTimeout(try_to_resolve, 0);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst { fulfil, reject } = deferred.get(id);\n\t\t\t\t\t\t\t\tdeferred.delete(id);\n\t\t\t\t\t\t\t\tif (error) reject(error);\n\t\t\t\t\t\t\t\telse fulfil(data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttry_to_resolve();\n\t\t\t\t\t\t}`)}r.push(`${D} = {\n\t\t\t\t\t\t${p.join(",\n\t\t\t\t\t\t")}\n\t\t\t\t\t};`);const f=["element"];if(r.push("const element = document.currentScript.parentElement;"),o.ssr){const r={form:"null",error:"null"};T&&(r.form=function(e,t,r){const s=e=>{for(const t in r){const n=r[t].encode(e);if(n)return`app.decode('${t}', ${y.uneval(n,s)})`}};return ze(e,e=>y.uneval(e,s),t)}(T,u.route.id,s.hooks.transport)),l&&(r.error=y.uneval(l));const a=[`node_ids: [${e.map(({node:e})=>e.index).join(", ")}]`,`data: ${F}`,`form: ${r.form}`,`error: ${r.error}`];if(200!==i&&a.push(`status: ${i}`),n._.client.routes){if(t){const e=lt(t,u.url,n).replaceAll("\n","\n\t\t\t\t\t\t\t");a.push(`params: ${y.uneval(u.params)}`,`server_route: ${e}`)}}else s.embedded&&a.push(`params: ${y.uneval(u.params)}`,`route: ${Xe(u.route)}`);const o="\t".repeat(c?7:6);f.push(`{\n${o}\t${a.join(`,\n${o}\t`)}\n${o}}`)}const{remote_data:m}=g;let _="";if(m){const e={};for(const[r,s]of m)if(r.id)for(const t in s)e[M(r.id,t)]=await s[t];const t=e=>{for(const r in s.hooks.transport){const n=s.hooks.transport[r].encode(e);if(n)return`app.decode('${r}', ${y.uneval(n,t)})`}};_=`${D}.data = ${y.uneval(e,t)};\n\n\t\t\t\t\t\t`}const v=b.inline?`${b.inline.script}\n\n\t\t\t\t\t${_}${D}.app.start(${f.join(", ")});`:b.app?`Promise.all([\n\t\t\t\t\t\timport(${Xe(I(b.start))}),\n\t\t\t\t\t\timport(${Xe(I(b.app))})\n\t\t\t\t\t]).then(([kit, app]) => {\n\t\t\t\t\t\t${_}kit.start(app, ${f.join(", ")});\n\t\t\t\t\t});`:`import(${Xe(I(b.start))}).then((app) => {\n\t\t\t\t\t\t${_}app.start(${f.join(", ")})\n\t\t\t\t\t});`;if(c?r.push(`import(${Xe(`${A}/${h}/env.js`)}).then(({ env }) => {\n\t\t\t\t\t\t${D}.env = env;\n\n\t\t\t\t\t\t${v.replace(/\n/g,"\n\t")}\n\t\t\t\t\t});`):r.push(v),s.service_worker){let e="";if(null!=s.service_worker_options){const t={...s.service_worker_options};e=`, ${Xe(t)}`}r.push(`if ('serviceWorker' in navigator) {\n\t\t\t\t\t\taddEventListener('load', function () {\n\t\t\t\t\t\t\tnavigator.serviceWorker.register('${I("service-worker.js")}'${e});\n\t\t\t\t\t\t});\n\t\t\t\t\t}`)}const $=`\n\t\t\t\t{\n\t\t\t\t\t${r.join("\n\n\t\t\t\t\t")}\n\t\t\t\t}\n\t\t\t`;L.add_script($),z+=`\n\t\t\t<script${L.script_needs_nonce?` nonce="${L.nonce}"`:""}>${$}<\/script>\n\t\t`}const J=new Headers({"x-sveltekit-page":"true","content-type":"text/html"});if(a.prerendering){const e=[],t=L.csp_provider.get_meta();t&&e.push(t),a.prerendering.cache&&e.push(`<meta http-equiv="cache-control" content="${a.prerendering.cache}">`),e.length>0&&(N=e.join("\n")+N)}else{const e=L.csp_provider.get_header();e&&J.set("content-security-policy",e);const t=L.report_only_provider.get_header();t&&J.set("content-security-policy-report-only",t),R.size&&J.set("link",Array.from(R).join(", "))}N+=O.head;const B=s.templates.app({head:N,body:z,assets:P,nonce:L.nonce,env:H}),V=await w.transformPageChunk({html:B,done:!0})||"";return G||J.set("etag",`"${Be(V)}"`),G?new Response(new ReadableStream({async start(e){e.enqueue(U.encode(V+"\n"));for await(const t of G)e.enqueue(U.encode(t));e.close()},type:"bytes"}),{headers:J}):r(V,{status:i,headers:J})}class ft{data;constructor(e){this.data=e}layouts(){return this.data.slice(0,-1)}page(){return this.data.at(-1)}validate(){for(const t of this.layouts())t&&(E(t.server,t.server_id),j(t.universal,t.universal_id));const e=this.page();e&&(x(e.server,e.server_id),R(e.universal,e.universal_id))}#m(e){return this.data.reduce((t,r)=>r?.universal?.[e]??r?.server?.[e]??t,void 0)}csr(){return this.#m("csr")??!0}ssr(){return this.#m("ssr")??!0}prerender(){return this.#m("prerender")??!1}trailing_slash(){return this.#m("trailingSlash")??"never"}get_config(){let e={};for(const t of this.data)(t?.universal?.config||t?.server?.config)&&(e={...e,...t?.universal?.config,...t?.server?.config});return Object.keys(e).length?e:void 0}should_prerender_data(){return this.data.some(e=>e?.server?.load||void 0!==e?.server?.trailingSlash)}}async function mt({event:e,event_state:t,options:r,manifest:s,state:n,status:a,error:i,resolve_opts:c}){if(e.request.headers.get("x-sveltekit-error"))return fe(r,a,i.message);const l=[];try{const o=[],u=await s._.nodes[0](),d=new ft([u]),p=d.ssr(),h=d.csr(),f=We(e,t,r);if(p){n.error=!0;const r=Me({event:e,event_state:t,state:n,node:u,parent:async()=>({})}),a=await r;f.add_node(0,a);const i=await Fe({event:e,event_state:t,fetched:l,node:u,parent:async()=>({}),resolve_opts:c,server_data_promise:r,state:n,csr:h});o.push({node:u,server_data:a,data:i},{node:await s._.nodes[1](),data:null,server_data:null})}return await ht({options:r,manifest:s,state:n,page_config:{ssr:p,csr:h},status:a,error:await _e(e,t,r,i),branch:o,fetched:l,event:e,event_state:t,resolve_opts:c,data_serializer:f})}catch(u){return u instanceof o?ye(u.status,u.location):fe(r,ne(u),(await _e(e,t,r,u)).message)}}async function _t(e,r,i,u,d){return Oe({name:"sveltekit.remote.call",attributes:{},fn:p=>{const h=l(e,p);return c({event:h,state:r},()=>async function(e,r,i,l,u){const[d,p,h]=u.split("/"),f=l._.remotes;f[d]||s(404);const m=(await f[d]()).default[p];m||s(404);const _=m.__,y=i.hooks.transport;let g;e.tracing.current.setAttributes({"sveltekit.remote.call.type":_.type,"sveltekit.remote.call.name":_.name});try{if("query_batch"===_.type){if("POST"!==e.request.method)throw new a(405,"Method Not Allowed",`\`query.batch\` functions must be invoked via POST request, not ${e.request.method}`);const{payloads:s}=await e.request.json(),o=s.map(e=>F(e,y)),l=await c({event:e,state:r},()=>_.run(o)),u=await Promise.all(o.map(async(t,s)=>{try{return{type:"result",data:l(t,s)}}catch(o){return{type:"error",error:await _e(e,r,i,o),status:o instanceof n||o instanceof a?o.status:500}}}));return t({type:"result",result:G(u,y)})}if("form"===_.type){if("POST"!==e.request.method)throw new a(405,"Method Not Allowed",`\`form\` functions must be invoked via POST request, not ${e.request.method}`);if(!re(e.request))throw new a(415,"Unsupported Media Type",`\`form\` functions expect form-encoded data — received ${e.request.headers.get("content-type")}`);const s=await e.request.formData();g=JSON.parse(s.get("sveltekit:remote_refreshes")??"[]"),s.delete("sveltekit:remote_refreshes"),h&&s.set("sveltekit:id",decodeURIComponent(h));const n=_.fn,o=await c({event:e,state:r},()=>n(s));return t({type:"result",result:G(o,y),refreshes:o.issues?{}:await w(g)})}if("command"===_.type){const{payload:s,refreshes:n}=await e.request.json(),a=F(s,y),o=await c({event:e,state:r},()=>m(a));return t({type:"result",result:G(o,y),refreshes:await w(n)})}const s="prerender"===_.type?h:new URL(e.request.url).searchParams.get("payload"),o=await c({event:e,state:r},()=>m(F(s,y)));return t({type:"result",result:G(o,y)})}catch(v){if(v instanceof o)return t({type:"redirect",location:v.location,refreshes:await w(g??[])});const s=v instanceof n||v instanceof a?v.status:500;return t({type:"error",error:await _e(e,r,i,v),status:s},{status:r.prerendering?s:void 0,headers:{"cache-control":"private, no-store"}})}async function w(t){const n=r.refreshes??{};for(const a of t){if(void 0!==n[a])continue;const[t,o,i]=a.split("/"),u=l._.remotes[t],d=(await(u?.()))?.default?.[o];d||s(400,"Bad Request"),n[a]=c({event:e,state:r},()=>d(F(i,y)))}if(0!==Object.keys(n).length)return G(Object.fromEntries(await Promise.all(Object.entries(n).map(async([e,t])=>[e,await t]))),y)}}(h,r,i,u,d))}})}async function yt(e,t,r,s){return Oe({name:"sveltekit.remote.form.post",attributes:{},fn:n=>{const i=l(e,n);return c({event:i,state:t},()=>async function(e,t,r,s){const[n,i,l]=s.split("/"),u=r._.remotes,d=await(u[n]?.());let p=d?.default[i];if(!p)return e.setHeaders({allow:"GET"}),{type:"error",error:new a(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page")};l&&(p=c({event:e,state:t},()=>p.for(JSON.parse(l))));try{const r=await e.request.formData(),s=p.__.fn;return l&&!r.has("id")&&r.set("sveltekit:id",decodeURIComponent(l)),await c({event:e,state:t},()=>s(r)),{type:"success",status:200}}catch(h){const e=h;return e instanceof o?{type:"redirect",status:e.status,location:e.location}:{type:"error",error:Ae(e)}}}(i,t,r,s))}})}async function gt(t,s,n,c,l,u,d,p){if(u.depth>10)return r(`Not found: ${t.url.pathname}`,{status:404});if(Te(t)){const e=await l._.nodes[n.leaf]();return async function(e,t,r,s){const n=s?.actions;if(!n){const s=new a(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page");return Ue({type:"error",error:await _e(e,t,r,s)},{status:s.status,headers:{allow:"GET"}})}Ce(n);try{const s=await He(e,t,n);return Ue(s instanceof i?{type:"failure",status:s.status,data:Ne(s.data,e.route.id,r.hooks.transport)}:{type:"success",status:s?200:204,data:Ne(s,e.route.id,r.hooks.transport)})}catch(c){const s=c;return s instanceof o?Pe(s):Ue({type:"error",error:await _e(e,t,r,Ae(s))},{status:ne(s)})}}(t,s,c,e?.server)}try{const f=d.page();let m,_=200;if(function(e){return"POST"===e.request.method}(t)){const e=t.url.searchParams.get("/remote");if(m=e?await yt(t,s,l,e):await async function(e,t,r){const s=r?.actions;if(!s)return e.setHeaders({allow:"GET"}),{type:"error",error:new a(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page")};Ce(s);try{const r=await He(e,t,s);return r instanceof i?{type:"failure",status:r.status,data:r.data}:{type:"success",status:200,data:r}}catch(n){const e=n;return e instanceof o?{type:"redirect",status:e.status,location:e.location}:{type:"error",error:Ae(e)}}}(t,s,f.server),"redirect"===m?.type)return ye(m.status,m.location);"error"===m?.type&&(_=ne(m.error)),"failure"===m?.type&&(_=m.status)}const y=d.prerender();if(y){const e=f.server;if(e?.actions)throw new Error("Cannot prerender pages with actions")}else if(u.prerendering)return new Response(void 0,{status:204});u.prerender_default=y;const g=d.should_prerender_data(),w=je(t.url.pathname),v=[],$=d.ssr(),b=d.csr();if(!(!1!==$||u.prerendering&&g))return e&&m&&t.request.headers.has("x-sveltekit-action"),await ht({branch:[],fetched:v,page_config:{ssr:!1,csr:b},status:_,error:null,event:t,event_state:s,options:c,manifest:l,state:u,resolve_opts:p,data_serializer:We(t,s,c)});const k=[];let E=null;const j=We(t,s,c),x=u.prerendering&&g?De(t,s,c):null,R=d.data.map((e,r)=>{if(E)throw E;return Promise.resolve().then(async()=>{try{if(e===f&&"error"===m?.type)throw m.error;const n=await Me({event:t,event_state:s,state:u,node:e,parent:async()=>{const e={};for(let t=0;t<r;t+=1){const r=await R[t];r&&Object.assign(e,r.data)}return e}});return e&&j.add_node(r,n),x?.add_node(r,n),n}catch(n){throw E=n,E}})}),q=d.data.map((e,r)=>{if(E)throw E;return Promise.resolve().then(async()=>{try{return await Fe({event:t,event_state:s,fetched:v,node:e,parent:async()=>{const e={};for(let t=0;t<r;t+=1)Object.assign(e,await q[t]);return e},resolve_opts:p,server_data_promise:R[r],state:u,csr:b})}catch(n){throw E=n,E}})});for(const e of R)e.catch(()=>{});for(const e of q)e.catch(()=>{});for(let e=0;e<d.data.length;e+=1){const a=d.data[e];if(a)try{const t=await R[e],r=await q[e];k.push({node:a,server_data:t,data:r})}catch(h){const a=se(h);if(a instanceof o){if(u.prerendering&&g){const e=JSON.stringify({type:"redirect",location:a.location});u.prerendering.dependencies.set(w,{response:r(e),body:e})}return ye(a.status,a.location)}const i=ne(a),d=await _e(t,s,c,a);for(;e--;)if(n.errors[e]){const r=n.errors[e],a=await l._.nodes[r]();let o=e;for(;!k[o];)o-=1;j.set_max_nodes(o+1);const h=be(k.slice(0,o+1)),f=new ft(h.map(e=>e.node));return await ht({event:t,event_state:s,options:c,manifest:l,state:u,resolve_opts:p,page_config:{ssr:f.ssr(),csr:f.csr()},status:i,error:d,branch:h.concat({node:a,data:null,server_data:null}),fetched:v,data_serializer:j})}return fe(c,i,d.message)}else k.push(null)}if(u.prerendering&&x){let{data:e,chunks:t}=x.get_data();if(t)for await(const r of t)e+=r;u.prerendering.dependencies.set(w,{response:r(e),body:e})}return await ht({event:t,event_state:s,options:c,manifest:l,state:u,resolve_opts:p,page_config:{csr:b,ssr:$},status:_,error:null,branch:!1===$?[]:be(k),action_result:m,fetched:v,data_serializer:!1===$?We(t,s,c):j})}catch(h){return await mt({event:t,event_state:s,options:c,manifest:l,state:u,status:500,error:h,resolve_opts:p})}}function wt(e,t=200){return r("string"==typeof e?e:JSON.stringify(e),{status:t,headers:{"content-type":"application/json","cache-control":"private, no-store"}})}function vt(e){return wt({type:"redirect",location:e.location})}const $t=/[\x00-\x1F\x7F()<>@,;:"/[\]?={} \t]/;function bt(e){if(void 0===e?.path)throw new Error("You must specify a `path` when setting, deleting or serializing cookies")}function kt(e,t){const r=e.headers.get("cookie")??"",s=V(r,{decode:e=>e});let n;const a=new Map,o={httpOnly:!0,sameSite:"lax",secure:"localhost"!==t.hostname||"http:"!==t.protocol},i={get(e,s){const n=Array.from(a.values()).filter(r=>r.name===e&&Et(t.hostname,r.options.domain)&&jt(t.pathname,r.options.path)).sort((e,t)=>t.options.path.length-e.options.path.length)[0];if(n)return 0===n.options.maxAge?void 0:n.value;return V(r,{decode:s?.decode})[e]},getAll(e){const s=V(r,{decode:e?.decode}),n=new Map;for(const r of a.values())if(Et(t.hostname,r.options.domain)&&jt(t.pathname,r.options.path)){const e=n.get(r.name);(!e||r.options.path.length>e.options.path.length)&&n.set(r.name,r)}for(const t of n.values())s[t.name]=t.value;return Object.entries(s).map(([e,t])=>({name:e,value:t}))},set(e,t,r){e.match($t);bt(r),l(e,t,{...o,...r})},delete(e,t){bt(t),i.set(e,"",{...t,maxAge:0})},serialize(e,r,s){bt(s);let a=s.path;if(!s.domain||s.domain===t.hostname){if(!n)throw new Error("Cannot serialize cookies until after the route is determined");a=S(n,a)}return Q(e,r,{...o,...s,path:a})}};const c=[];function l(e,r,s){if(!n)return void c.push(()=>l(e,r,s));let o=s.path;s.domain&&s.domain!==t.hostname||(o=S(n,o));const i=function(e,t,r){return`${e||""}${t}?${encodeURIComponent(r)}`}(s.domain,o,e),u={name:e,value:r,options:{...s,path:o}};a.set(i,u)}return{cookies:i,new_cookies:a,get_cookie_header:function(e,t){const r={...s};for(const s of a.values()){if(!Et(e.hostname,s.options.domain))continue;if(!jt(e.pathname,s.options.path))continue;const t=s.options.encode||encodeURIComponent;r[s.name]=t(s.value)}if(t){const e=V(t,{decode:e=>e});for(const t in e)r[t]=e[t]}return Object.entries(r).map(([e,t])=>`${e}=${t}`).join("; ")},set_internal:l,set_trailing_slash:function(e){n=q(t.pathname,e),c.forEach(e=>e())}}}function Et(e,t){if(!t)return!0;const r="."===t[0]?t.slice(1):t;return e===r||e.endsWith("."+r)}function jt(e,t){if(!t)return!0;const r=t.endsWith("/")?t.slice(0,-1):t;return e===r||e.startsWith(r+"/")}function xt(e,t){for(const r of t){const{name:t,value:s,options:n}=r;if(e.append("set-cookie",Q(t,s,n)),n.path.endsWith(".html")){const r=je(n.path);e.append("set-cookie",Q(t,s,{...n,path:r}))}}}function Rt({event:e,options:t,manifest:r,state:s,get_cookie_header:n,set_internal:a}){const o=async(o,i)=>{const c=qt(o,i,e.url);let l=(o instanceof Request?o.mode:i?.mode)??"cors",u=(o instanceof Request?o.credentials:i?.credentials)??"same-origin";return t.hooks.handleFetch({event:e,request:c,fetch:async(o,i)=>{const h=qt(o,i,e.url),f=new URL(h.url);if(h.headers.has("origin")||h.headers.set("origin",e.url.origin),o!==c&&(l=(o instanceof Request?o.mode:i?.mode)??"cors",u=(o instanceof Request?o.credentials:i?.credentials)??"same-origin"),"GET"!==h.method&&"HEAD"!==h.method||("no-cors"!==l||f.origin===e.url.origin)&&f.origin!==e.url.origin||h.headers.delete("origin"),f.origin!==e.url.origin){if(`.${f.hostname}`.endsWith(`.${e.url.hostname}`)&&"omit"!==u){const e=n(f,h.headers.get("cookie"));e&&h.headers.set("cookie",e)}return fetch(h)}const m=d||p,_=decodeURIComponent(f.pathname),y=(_.startsWith(m)?_.slice(m.length):_).slice(1),g=`${y}/index.html`,w=r.assets.has(y)||y in r._.server_assets,v=r.assets.has(g)||g in r._.server_assets;if(w||v){const e=w?y:g;if(s.read){const t=w?r.mimeTypes[y.slice(y.lastIndexOf("."))]:"text/html";return new Response(s.read(e),{headers:t?{"content-type":t}:{}})}if(N&&e in r._.server_assets){const t=r._.server_assets[e],s=r.mimeTypes[e.slice(e.lastIndexOf("."))];return new Response(N(e),{headers:{"Content-Length":""+t,"Content-Type":s}})}return await fetch(h)}if(ve(r,p+_))return await fetch(h);if("omit"!==u){const t=n(f,h.headers.get("cookie"));t&&h.headers.set("cookie",t);const r=e.request.headers.get("authorization");r&&!h.headers.has("authorization")&&h.headers.set("authorization",r)}h.headers.has("accept")||h.headers.set("accept","*/*"),h.headers.has("accept-language")||h.headers.set("accept-language",e.request.headers.get("accept-language"));const $=await async function(e,t,r,s){if(e.signal){if(e.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");let n=()=>{};const a=new Promise((t,r)=>{const s=()=>{r(new DOMException("The operation was aborted.","AbortError"))};e.signal.addEventListener("abort",s,{once:!0}),n=()=>e.signal.removeEventListener("abort",s)}),o=await Promise.race([Nt(e,t,r,{...s,depth:s.depth+1}),a]);return n(),o}return await Nt(e,t,r,{...s,depth:s.depth+1})}(h,t,r,s),b=$.headers.get("set-cookie");if(b)for(const e of X.splitCookiesString(b)){const{name:t,value:r,...s}=X.parseString(e,{decodeValues:!1}),n=s.path??(f.pathname.split("/").slice(0,-1).join("/")||"/");a(t,r,{path:n,encode:e=>e,...s})}return $}})};return(e,t)=>{const r=o(e,t);return r.catch(()=>{}),r}}function qt(e,t,r){return e instanceof Request?e:new Request("string"==typeof e?new URL(e,r):e,t)}let St,Ot,Tt;const At=({html:e})=>e,Pt=()=>!1,Ut=({type:e})=>"js"===e||"css"===e,Ct=new Set(["GET","HEAD","POST"]),Ht=new Set(["GET","HEAD","OPTIONS"]);const Nt=(zt=async function(s,i,u,d){const f=new URL(s.url),m=f.pathname.endsWith(xe),_=function(e){return e.endsWith(ke)||e.endsWith(Ee)}(f.pathname),y=function(e){return e.pathname.startsWith(`${p}/${h}/remote/`)&&e.pathname.replace(`${p}/${h}/remote/`,"")}(f);{const e=s.headers.get("origin");if(y){if("GET"!==s.method&&e!==f.origin)return t({message:"Cross-site remote requests are forbidden"},{status:403})}else if(i.csrf_check_origin&&re(s)&&("POST"===s.method||"PUT"===s.method||"PATCH"===s.method||"DELETE"===s.method)&&e!==f.origin&&(!e||!i.csrf_trusted_origins.includes(e))){const e=`Cross-site ${s.method} form submissions are forbidden`,n={status:403};return"application/json"===s.headers.get("accept")?t({message:e},n):r(e,n)}}if(i.hash_routing&&f.pathname!==p+"/"&&"/[fallback]"!==f.pathname)return r("Not found",{status:404});let g;m?f.pathname=function(e){return e.slice(0,-11)}(f.pathname):_?(f.pathname=function(e){return e.endsWith(Ee)?e.slice(0,-16)+".html":e.slice(0,-12)}(f.pathname)+("1"===f.searchParams.get(J)?"/":"")||"/",f.searchParams.delete(J),g=f.searchParams.get(B)?.split("").map(e=>"1"===e),f.searchParams.delete(B)):y&&(f.pathname=s.headers.get("x-sveltekit-pathname")??p,f.search=s.headers.get("x-sveltekit-search")??"");const $={},{cookies:b,new_cookies:k,get_cookie_header:E,set_internal:j,set_trailing_slash:x}=kt(s,f),R={prerendering:d.prerendering,transport:i.hooks.transport,handleValidationError:i.hooks.handleValidationError,tracing:{record_span:Oe},is_in_remote_function:!1},S={cookies:b,fetch:null,getClientAddress:d.getClientAddress||(()=>{throw new Error("@sveltejs/adapter-static does not specify getClientAddress. Please raise an issue")}),locals:{},params:{},platform:d.platform,request:s,route:{id:null},setHeaders:e=>{for(const t in e){const r=t.toLowerCase(),s=e[t];if("set-cookie"===r)throw new Error("Use `event.cookies.set(name, value, options)` instead of `event.setHeaders` to set cookies");if(r in $)throw new Error(`"${t}" header is already set`);$[r]=s,d.prerendering&&"cache-control"===r&&(d.prerendering.cache=s)}},url:f,isDataRequest:_,isSubRequest:d.depth>0,isRemoteRequest:!!y};S.fetch=Rt({event:S,options:i,manifest:u,state:d,get_cookie_header:E,set_internal:j}),d.emulator?.platform&&(S.platform=await d.emulator.platform({config:{},prerender:!!d.prerendering?.fallback}));let T=f.pathname;if(!y){const e=d.prerendering?.inside_reroute;try{d.prerendering&&(d.prerendering.inside_reroute=!0),T=await i.hooks.reroute({url:new URL(f),fetch:S.fetch})??f.pathname}catch{return r("Internal Server Error",{status:500})}finally{d.prerendering&&(d.prerendering.inside_reroute=e)}}try{T=O(T)}catch{return r("Malformed URI",{status:400})}if(T!==f.pathname&&!d.prerendering?.fallback&&ve(u,T)){const e=new URL(s.url);e.pathname=_?je(T):m?Re(T):T;const t=await fetch(e,s),r=new Headers(t.headers);return r.has("content-encoding")&&(r.delete("content-encoding"),r.delete("content-length")),new Response(t.body,{headers:r,status:t.status,statusText:t.statusText})}let A=null;if(p&&!d.prerendering?.fallback){if(!T.startsWith(p))return r("Not found",{status:404});T=T.slice(p.length)||"/"}if(m)return async function(e,t,s){if(!s._.client.routes)return r("Server-side route resolution disabled",{status:400});let n=null,a={};const o=await s._.matchers();for(const r of s._.client.routes){const t=r.pattern.exec(e);if(!t)continue;const s=ct(t,r.params,o);if(s){n=r,a=v(s);break}}return dt(n,a,t,s).response}(T,new URL(s.url),u);if(T===`/${h}/env.js`)return function(e){return St??=`export const env=${JSON.stringify(H)}`,Ot??=`W/${Date.now()}`,Tt??=new Headers({"content-type":"application/javascript; charset=utf-8",etag:Ot}),e.headers.get("if-none-match")===Ot?new Response(void 0,{status:304,headers:Tt}):new Response(St,{headers:Tt})}(s);if(!y&&T.startsWith(`/${h}`)){const e=new Headers;return e.set("cache-control","public, max-age=0, must-revalidate"),r("Not found",{status:404,headers:e})}if(!d.prerendering?.fallback){const e=await u._.matchers();for(const t of u._.routes){const r=t.pattern.exec(T);if(!r)continue;const s=ct(r,t.params,e);if(s){A=t,S.route={id:A.id},S.params=v(s);break}}}let P={transformPageChunk:At,filterSerializedResponseHeaders:Pt,preload:Ut},C="never";try{const t=A?.page?new ft(await function(e,t){return Promise.all([...e.layouts.map(e=>null==e?e:t._.nodes[e]()),t._.nodes[e.leaf]()])}(A.page,u)):void 0;if(A&&!y){if(f.pathname===p||f.pathname===p+"/")C="always";else if(t)C=t.trailing_slash();else if(A.endpoint){const e=await A.endpoint();C=e.trailingSlash??"never"}if(!_){const e=q(f.pathname,C);if(e!==f.pathname&&!d.prerendering?.fallback)return new Response(void 0,{status:308,headers:{"x-sveltekit-normalize":"1",location:(e.startsWith("//")?f.origin+e:e)+("?"===f.search?"":f.search)}})}if(d.before_handle||d.emulator?.platform){let e={},r=!1;if(A.endpoint){const t=await A.endpoint();e=t.config??e,r=t.prerender??r}else t&&(e=t.get_config()??e,r=t.prerender());d.before_handle&&d.before_handle(S,e,r),d.emulator?.platform&&(S.platform=await d.emulator.platform({config:e,prerender:r}))}}x(C),!d.prerendering||d.prerendering.fallback||d.prerendering.inside_reroute||w(f);const h=await Oe({name:"sveltekit.handle.root",attributes:{"http.route":S.route.id||"unknown","http.method":S.request.method,"http.url":S.url.href,"sveltekit.is_data_request":_,"sveltekit.is_sub_request":S.isSubRequest},fn:async p=>{const h={...S,tracing:{enabled:!1,root:p,current:p}};return await c({event:h,state:R},()=>i.hooks.handle({event:h,resolve:(p,h)=>Oe({name:"sveltekit.resolve",attributes:{"http.route":p.route.id||"unknown"},fn:f=>c(null,()=>async function(t,l,p){try{if(p&&(P={transformPageChunk:p.transformPageChunk||At,filterSerializedResponseHeaders:p.filterSerializedResponseHeaders||Pt,preload:p.preload||Ut}),i.hash_routing||d.prerendering?.fallback)return await ht({event:t,event_state:R,options:i,manifest:u,state:d,page_config:{ssr:!1,csr:!0},status:200,error:null,branch:[],fetched:[],resolve_opts:P,data_serializer:We(t,R,i)});if(y)return await _t(t,R,i,u,y);if(A){const e=t.request.method;let r;if(_)r=await async function(e,t,r,s,i,c,l,u){if(!r.page)return new Response(void 0,{status:404});try{const d=[...r.page.layouts,r.page.leaf],p=l??d.map(()=>!0);let h=!1;const f=new URL(e.url);f.pathname=q(f.pathname,u);const m={...e,url:f},_=d.map((e,r)=>function(e){let t,r=!1;return()=>r?t:(r=!0,t=e())}(async()=>{try{if(h)return{type:"skip"};const s=null==e?e:await i._.nodes[e]();return Me({event:m,event_state:t,state:c,node:s,parent:async()=>{const e={};for(let t=0;t<r;t+=1){const r=await _[t]();r&&Object.assign(e,r.data)}return e}})}catch(s){throw h=!0,s}})),y=_.map(async(e,t)=>p[t]?e():{type:"skip"});let g=y.length;const w=await Promise.all(y.map((r,i)=>r.catch(async r=>{if(r instanceof o)throw r;return g=Math.min(g,i+1),{type:"error",error:await _e(e,t,s,r),status:r instanceof n||r instanceof a?r.status:void 0}}))),v=De(e,t,s);for(let e=0;e<w.length;e++)v.add_node(e,w[e]);const{data:$,chunks:b}=v.get_data();return b?new Response(new ReadableStream({async start(e){e.enqueue(U.encode($));for await(const t of b)e.enqueue(U.encode(t));e.close()},type:"bytes"}),{headers:{"content-type":"text/sveltekit-data","cache-control":"private, no-store"}}):wt($)}catch(d){const r=d;return r instanceof o?vt(r):wt(await _e(e,t,s,r),500)}}(t,R,A,i,u,d,g,C);else if(!A.endpoint||A.page&&!function(e){const{method:t,headers:r}=e.request;return!(!K.includes(t)||ee.includes(t))||("POST"!==t||"true"!==r.get("x-sveltekit-action"))&&"text/html"!==te(e.request.headers.get("accept")??"*/*",["*","text/html"])}(t)){if(!A.page)throw new Error("Route is neither page nor endpoint. This should never happen");if(!l)throw new Error("page_nodes not found. This should never happen");if(Ct.has(e))r=await gt(t,R,A.page,i,u,d,l,P);else{const t=new Set(Ht),s=await u._.nodes[A.page.leaf]();s?.server?.actions&&t.add("POST"),r="OPTIONS"===e?new Response(null,{status:204,headers:{allow:Array.from(t.values()).join(", ")}}):de([...t].reduce((e,t)=>(e[t]=!0,e),{}),e)}}else r=await async function(e,t,r,s){const n=e.request.method;let a=r[n]||r.fallback;if("HEAD"===n&&!r.HEAD&&r.GET&&(a=r.GET),!a)return de(r,n);const i=r.prerender??s.prerender_default;if(i&&(r.POST||r.PATCH||r.PUT||r.DELETE))throw new Error("Cannot prerender endpoints that have mutative methods");if(s.prerendering&&!s.prerendering.inside_reroute&&!i){if(s.depth>0)throw new Error(`${e.route.id} is not prerenderable`);return new Response(void 0,{status:204})}t.is_endpoint_request=!0;try{const r=await c({event:e,state:t},()=>a(e));if(!(r instanceof Response))throw new Error(`Invalid response from route ${e.url.pathname}: handler should return a Response object`);if(s.prerendering&&(!s.prerendering.inside_reroute||i)){const t=new Response(r.clone().body,{status:r.status,statusText:r.statusText,headers:new Headers(r.headers)});if(t.headers.set("x-sveltekit-prerender",String(i)),!s.prerendering.inside_reroute||!i)return t;t.headers.set("x-sveltekit-routeid",encodeURI(e.route.id)),s.prerendering.dependencies.set(e.url.pathname,{response:t,body:null})}return r}catch(l){if(l instanceof o)return new Response(void 0,{status:l.status,headers:{location:l.location}});throw l}}(t,R,await A.endpoint(),d);if("GET"===s.method&&A.page&&A.endpoint){const e=r.headers.get("vary")?.split(",")?.map(e=>e.trim().toLowerCase());e?.includes("accept")||e?.includes("*")||(r=new Response(r.body,{status:r.status,statusText:r.statusText,headers:new Headers(r.headers)}),r.headers.append("Vary","Accept"))}return r}if(d.error&&t.isSubRequest){const e=new Headers(s.headers);return e.set("x-sveltekit-error","true"),await fetch(s,{headers:e})}if(d.error)return r("Internal Server Error",{status:500});if(0===d.depth)return e&&t.url.pathname,await mt({event:t,event_state:R,options:i,manifest:u,state:d,status:404,error:new a(404,"Not Found",`Not found: ${t.url.pathname}`),resolve_opts:P});if(d.prerendering)return r("not found",{status:404});const h=await fetch(s);return new Response(h.body,h)}catch(h){return await me(t,R,i,h)}finally{t.cookies.set=()=>{throw new Error("Cannot use `cookies.set(...)` after the response has been generated")},t.setHeaders=()=>{throw new Error("Cannot use `setHeaders(...)` after the response has been generated")}}}(l(p,f),t,h).then(e=>{for(const t in $){const r=$[t];e.headers.set(t,r)}return xt(e.headers,k.values()),d.prerendering&&null!==p.route.id&&e.headers.set("x-sveltekit-routeid",encodeURI(p.route.id)),f.setAttributes({"http.response.status_code":e.status,"http.response.body.size":e.headers.get("content-length")||"unknown"}),e}))})}))}});if(200===h.status&&h.headers.has("etag")){let e=s.headers.get("if-none-match");e?.startsWith('W/"')&&(e=e.substring(2));const t=h.headers.get("etag");if(e===t){const e=new Headers({etag:t});for(const t of["cache-control","content-location","date","expires","vary","set-cookie"]){const r=h.headers.get(t);r&&e.set(t,r)}return new Response(void 0,{status:304,headers:e})}}if(_&&h.status>=300&&h.status<=308){const e=h.headers.get("location");if(e)return vt(new o(h.status,e))}return h}catch(N){if(N instanceof o){const e=_||y?vt(N):A?.page&&Te(S)?Pe(N):ye(N.status,N.location);return xt(e.headers,k.values()),e}return await me(S,R,i,N)}},async(e,...t)=>zt(e,...t));var zt;function Lt(e,t,r){return Object.fromEntries(Object.entries(e).filter(([e])=>e.startsWith(t)&&(""===r||!e.startsWith(r))))}let It,Wt=null;class Dt{#_;#y;constructor(e){if(this.#_=z,this.#y=e,Z){const e=this.respond.bind(this);this.respond=async(...t)=>{const{promise:r,resolve:s}=function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}(),n=Wt;return Wt=r,await n,e(...t).finally(s)}}}async init({env:e,read:t}){const{env_public_prefix:r,env_private_prefix:s}=this.#_;if(L(Lt(e,s,r)),I(Lt(e,r,s)),t){D(e=>{const r=t(e);return r instanceof ReadableStream?r:new ReadableStream({async start(e){try{const t=await Promise.resolve(r);if(!t)return void e.close();const s=t.getReader();for(;;){const{done:t,value:r}=await s.read();if(t)break;e.enqueue(r)}e.close()}catch(t){e.error(t)}}})})}await(It??=(async()=>{try{const e=await W();this.#_.hooks={handle:e.handle||(({event:e,resolve:t})=>t(e)),handleError:e.handleError||(({status:e,error:t,event:r})=>{!function(e,t,r){const s=`\n[1;31m[${e}] ${r.request.method} ${r.url.pathname}[0m`;404===e||t.stack}(e,t,r)}),handleFetch:e.handleFetch||(({request:e,fetch:t})=>t(e)),handleValidationError:e.handleValidationError||(({issues:e})=>({message:"Bad Request"})),reroute:e.reroute||(()=>{}),transport:e.transport||{}},e.transport&&Object.fromEntries(Object.entries(e.transport).map(([e,t])=>[e,t.decode])),e.init&&await e.init()}catch(e){throw e}})())}async respond(e,t){return Nt(e,this.#_,this.#y,{...t,error:!1,depth:0})}}export{Dt as Server};
